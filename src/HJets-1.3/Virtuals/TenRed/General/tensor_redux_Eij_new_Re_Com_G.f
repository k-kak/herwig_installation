CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C                tens_red5 = 5-point tensors
C     Francisco Campanario
C    Email: Francam@particle.uni-karlsruhe.de
C Date: 6/2/2008
C However, I am using the convention of Passarino-Vetlman for the tensor
C integrals. In this way, we avoid to convert the Dij from Passarino to Denner
C and later on to convert the Eij from Denner to Passarino Convection.
C In this file, we should put as an input the 10 scalar invariants, 
C the 5 D0, and the Dij got it from tens_red4_new_Re_Com.
C Notation: Example DR2345. the "R" means the real part of D02345
C                   DI2345, the "I" means the imaginary part of D02345
C This separation is done already in tens_red4_....
C It speeds up the code. 
C OUTPUT:  is given in E(Real part) and C(complex part) 
C NOTE!!!! The code seems to be 6 to 7 times faster than the old one and more stable.
C The indices are pertumted in comparison with the old subroutines.
C the rank of the tensor integral is store in the second argument.
C D_old(1,3)-> D(3,1)(rank 1 coefficient 3) it is faster in this way.
C The recursion relation that are implemented can not be found in the literature.
C I did it myself, so, one has to look into my notes if want to generalize them.
C I have as well the case of a massive loop with one mass with no restrictions in the invariants.
C I have more version which only needs the input in complex form
C and the output is given as a complex array. The subroutine still makes the separation
C between imaginary part and real part, but it is done inside of it. Here I am saving doing that since 
C I need and use this DR and DI in my penline subroutine.
C If you need other case ask me!
C Change:30/10/2008
C(Including general kinematics in Caley determinants and masses, this is necessary for the hexagons)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
      subroutine tens_red5_new_Re_Com_G(m0,m1,m2,m3,m4,p1, p2, p3, p4,
     1                     p1p2, p1p3,p1p4, p2p3,p2p4,p3p4, 
     2                     DR2345,DR1345,DR1245,DR1235,DR1234,
     3                     DRR2345,DRR1345,DRR1245,DRR1235,DRR1234,
     4                     DI2345,DI1345,DI1245,DI1235,DI1234,
     5                     DII2345,DII1345,DII1245,DII1235,DII1234,
     6                     E,C)
      implicit none
      real*8 p1,p2,p3,p4,p5,p1p2,p1p3,p1p4,p2p3,p2p4,p3p4
c$$$      complex*16 D0_2345,D0_1345,D0_1245,D0_1235,D0_1234
c$$$      complex*16 Dij_2345(13,3),Dij_1345(13,3),Dij_1245(13,3),
c$$$     #     Dij_1235(13,3),Dij_1234(13,3)
      complex*16 Eij(46,4)
c                                                             d^4k
c
c   E0; E_mu; E_mu,nu; E_mu,nu,rho; E_mu,nu,rho_sig  =  Int -------
c                                                           (2pi)^4
c
c   1; k_mu; k_mu k_nu; k_mu k_nu k_rho; k_mu k_nu k_rho k_sig
c --------------------------------------------------------------------------
c   (k^2-m0sq) ( (k+p1)^2-m1sq)  ((k+p1+p2)-m2sq)  ((k+p1+p2+p3)^2-m3sq)  ((k+p1+p2+p3+p4)^2-m4sq)
c
c  with
c
c   E_mu = p1_mu E11  +  p2_mu E12  +  p3_mu E13  +  p4_mu E14
c
c   E_munu = p1_mu p1_nu E21 + p2_mu p2_nu E22 + ...
c
c
C INPUT:  p1sq, p1p2,...                     kinematics invariants
c         D0_1345 = D00(p1+p2,p3,p4)          scalar 4-point functions
c         D0_1245 = D00(p1,p2+p3,p4)          in the PV notation
c         D0_1234 = D00(p1,p2,p3)
c         D0_1235 = D00(p1,p2,p3+p4)      
c         D0_2345 = D00(p2,p3,p4)

C         Dij_1235(n,m) = D_nm(1,2,3,5) ....    higher D_nm form factors
C                                               as in tens_red3 and tens_red4
c         E0 = E0(p,q,l,t)                      scalar five point function
c
c OUTPUT: Eij(n,m) = E_nm                    form factors in the tensor 
c                                            integrals a la PV
c         nm = 11, 21, 31, 41                ff's for E_mu
c         nm = 12, 22, 32, ..., 112    ff's for E_munu
c         nm = 13, 23, 33, ..., 233, 243     ff's for E_mu,nu,rho
c         nm = 14, 24, 34, ..., 454, 464
c
      real*8 R(4),R1(4),R2(4),R3(4),R4(4),R11(4),R12(4),R13(4)
      real*8 R14(4),R22(4),R23(4),R24(4),R33(4),R34(4),R44(4)
      real*8 R111(4),R112(4),R113(4),R114(4),R221(4),R222(4),R223(4)
      real*8 R224(4),R331(4),R332(4),R333(4),R334(4),R441(4),R442(4)
      real*8 R443(4),R444(4),R123(4),R124(4),R134(4),R234(4)

      real*8 s12,s23,s34,s45,s15!,s12sq,s45sq,s1523,s15m23,s15m34,s1534
c      real*8 s15mp2,p2t45,st1223mp245,aux1,aux2,aux3,s1215,s15p2,s45mp4
c      real*8  p2sq,sts15m23,p5sq,
      real*8  d,Id,I2,I3,I4,d2,d3,d4
      real*8  Y123,Y124,Y134,Y213,Y214,Y234,Y312,Y314,Y324,Y412,Y413,Y423
      real*8  x(1:4,0:4), Y(4,4,4),ER,EI
      real*8 DR2345,DR1345,DR1245,DR1235,DR1234,DRR1234(13,3),E(46,4)
      real*8 DRR2345(13,3),DRR1345(13,3),DRR1245(13,3),DRR1235(13,3)
      real*8 DI2345,DI1345,DI1245,DI1235,DI1234,DII1234(13,3),C(46,4)
      real*8 DII2345(13,3),DII1345(13,3),DII1245(13,3),DII1235(13,3)
      real*8 p12,p22,p32,p42,p52,s12s,s23s,s34s,s45s,s15s
      real*8 eps
      Parameter(eps=1d-07)
      Integer i,j 
c Added for General case
      real*8 m0,m1,m2,m3,m4,m0sq,m1sq,m2sq,m3sq,m4sq,r1r0,r2r1,r3r2,r4r3
      
      m0sq=m0*m0
      m1sq=m1*m1
      m2sq=m2*m2
      m3sq=m3*m3
      m4sq=m4*m4





c s_ij=(p_i+p_j)^2
      s12=2.d0*p1p2+p2+p1
      s23=2.d0*p2p3+p2+p3      
      s34=2.d0*p3p4+p3+p4
      s45=p1+p2+p3+2d0*(p1p2+p1p3+p2p3)
      s15=p2+p3+p4+2d0*(p2p3+p2p4+p3p4)
      p5=s15+p1+2d0*(p1p2+p1p3+p1p4)


      r1r0=(p1-m1sq)+m0sq
      r2r1=(s12-m2sq)-(p1-m1sq)
      r3r2=(s45-m3sq)-(s12-m2sq)
      r4r3=(p5-m4sq) -(s45-m3sq)


      p12=p1*p1
      p22=p2*p2
      p32=p3*p3
      p42=p4*p4
      p52=p5*p5

      s12s=s12*s12
      s23s=s23*s23
      s34s=s34*s34
      s45s=s45*s45
      s15s=s15*s15    

c General Caley Determinats and so on

       d= 32*m0sq*(p1p3**2*p2p4**2-p1*p2p4**2*p3+p1p4**2*(p2p3**2-p2*p
     -   3)+p1p2**2*p3p4**2-p1*p2*p3p4**2-2*(p1p2*p1p3*p2p4*p3p4-p1*p
     -   2p3*p2p4*p3p4+p1p4*(p1p3*p2p3*p2p4-p1p2*p2p4*p3-p1p3*p2*p3p4
     -   +p1p2*p2p3*p3p4))-(p1p3**2*p2-2*p1p2*p1p3*p2p3+p1*p2p3**2+p1
     -   p2**2*p3-p1*p2*p3)*p4)+2*(r1r0**2*(p22*p4+s15*(p32+p4*s23-p3
     -   *(p4-s15+s23))-((p4+s15-s23)*s23+p3*(-p4+s15+s23))*s34-p2*(-
     -   p42+p3*(p4+s15-s23)+(-s15+s23)*s34+p4*(s15+s23+s34))+s23*s34
     -   s)+r3r2**2*(p12*p4+p22*p4+p1*(-2*p4*(p2+s12)+(p3+s15-s23-s34
     -   )*(p3+p5-s34-s45))+p2*(-2*p4*s12+(p5-s15+s23-s45)*(p3+p5-s34
     -   -s45))+s12*(p4*s12+(p3+s15-s23-s34)*(-p5+s15-s23+s45)))+r1r0
     -   *(r4r3*(-(p32*p5)+p3*p4*s12+p32*s15-p3*s12*s15-p3*s12*s23-p4
     -   *s12*s23-p3*s15*s23-s12*s15*s23-p5*s23s+s12*s23s-p3*s23*s34+
     -   s23s*s34+2*(p3*p5*s23+s12*s23*s34)-p1*(-p32+p2*(p3+p4-s34)+s
     -   23*(-p4+s34)+p3*(p4-2*s15+s23+s34))-(p3-s23)*(s15-s34)*s45+p
     -   22*(p4-p5+s45)-p2*(-(s12*s15)-2*p5*s23+s12*s23+s23*s34+p4*(s
     -   12+s23-2*s45)+(s15+s23+s34)*s45+p3*(p4+s15-2*(p5+s23)+s45)))
     -   +r2r1*(-(p32*p5)+p3*p4*p5+p3*p4*s12-p42*s12+p32*s15-p3*p4*s1
     -   5+p3*s12*s15+p4*s12*s15+p3*p5*s23-p4*p5*s23-p3*s12*s23+p4*s1
     -   2*s23+p3*p5*s34+p4*s12*s34-p3*s15*s34-s12*s15*s34-p3*s23*s34
     -   -p4*s23*s34+p5*s23*s34+s12*s23*s34+2*(p22*p4-p3*p5*s15+p3*s1
     -   5s-p3*s15*s23+p4*s15*s23-s15*s23*s34+s23s*s34)+p1*(p32+(p4-s
     -   34)**2-2*p3*(p4+s34))+s23*s34s+((p3-p4)*s15+(p3+p4+s15-2*s23
     -   )*s34-s34s)*s45+p2*(p42+s34*(-p5+2*(s15-s23)+s45)-p3*(p4-p5+
     -   2*(s15-s23)+s45)+p4*(p5-2*(s12+s15+s23)-s34+s45)))+r3r2*(-(p
     -   32*p5)+p3*p4*s12+p32*s15-p3*p5*s15+p3*s12*s15-p4*s12*s15+p3*
     -   s15s+s12*s15s-p3*s12*s23-p4*s12*s23-p3*s15*s23+p5*s15*s23+2*
     -   (p22*p4+p3*p5*s23-s12*s15*s23)-p5*s23s+s12*s23s+p3*p5*s34+p4
     -   *s12*s34-p3*s15*s34-s12*s15*s34-p3*s23*s34-p5*s23*s34+s12*s2
     -   3*s34-s15*s23*s34+s23s*s34+p1*(p32-2*p2*p4+p4*(s15+s23-s34)+
     -   s34*(-s15+s23+s34)-p3*(p4-s15+s23+2*s34))+s23*s34s-(s15-s34)
     -   *(p3+s15-s23-s34)*s45-p2*(p5*s15-p5*s23+p5*s34-2*(s15*s34-s2
     -   3*s34)-(s15-s23+s34)*s45+p3*(p4-p5+2*(s15-s23)+s45)+p4*(s15+
     -   s23+s34-2*(p5-s12+s45)))))+r3r2*r4r3*(p12*(p3+p4-s34)+p22*(p
     -   4-p5+s45)+s12*(p4*s12+s12*(-s15+s23)+s23*(p5-2*(s15-s23)+s34
     -   )+p3*(-p5+s15-2*(s23-s45))+(s15-2*s23-s34)*s45)+p1*(s12*s15-
     -   p5*s23-s12*s23+s12*s34+s23*s34+p2*(-p3-2*p4+p5+s34-s45)-s15*
     -   s45+s34*s45+2*(p32-p4*s12+s23*s45)+p3*(p5-s12+s15-2*(s23+s34
     -   +s45)))+p2*(s12*s15-s12*s23-s23*s34+p3*(p5-s15+2*(s23-s45))+
     -   p5*(s12+s23-2*s45)-s12*s45+s15*s45+s34*s45-2*(p4*s12+s23*s45
     -   -s45s)))+r2r1**2*(p22*p4+p3*p52-p3*p5*s12-p4*p5*s12+p4*s12s-
     -   2*p3*p5*s15+p3*s12*s15+p4*s12*s15+p3*s15s+p3*p5*s23-p4*p5*s2
     -   3-p3*s12*s23+p4*s12*s23-p3*s15*s23+p4*s15*s23+p5*s12*s34-s12
     -   *s15*s34+p5*s23*s34+s12*s23*s34-s15*s23*s34+s23s*s34+p1*(p32
     -   +(p4-s34)**2-2*p3*(p4+s34))-((p3-p4)*(p5-s12-s15)+(p5+s12-s1
     -   5+2*s23)*s34)*s45+p2*(p3*(p5-s15+s23-s45)+p4*(p5-2*s12-s15-s
     -   23+s45)+s34*(-p5+s15-s23+s45))+s34*s45s)+r4r3**2*(p12*p3+s12
     -   *s23*(-p3+s12+s23)+p22*s45+s12*(p3-s23)*s45-p1*(-p32+s23*(s1
     -   2-s45)+p2*(p3-s12+s45)+p3*(s12+s23+s45))+p2*((p3-s12)*s23-(p
     -   3+s12+s23)*s45+s45s))+r2r1*(r3r2*(p3*p52-p4*p5*s12+p4*s12*s1
     -   5-p5*s12*s15+p3*s15s+s12*s15s+p3*p5*s23-p52*s23+p4*s12*s23+p
     -   5*s12*s23-p3*s15*s23+p5*s15*s23-p5*s23s+s12*s23s+p5*s23*s34-
     -   s15*s23*s34+s23s*s34+2*(p22*p4-p3*p5*s12+p4*s12s-p3*p5*s15+p
     -   3*s12*s15-p3*s12*s23-s12*s15*s23+p5*s12*s34-s12*s15*s34+s12*
     -   s23*s34)-(p4*s12+p3*(p5-2*s12-s15)-(s12-s15)*(s15-s23)-p5*(s
     -   15+s23-s34)+(-s15+2*(s12+s23))*s34)*s45+p2*(2*p3*(p5-s15+s23
     -   -s45)+(p5-s15+s23-s45)*(p5-2*s34-s45)+p4*(p5-4*s12-s15-s23+s
     -   45))+p1*(2*(p32-p2*p4)+s34*(-p5-s15+s23+2*s34+s45)-p3*(2*p4-
     -   p5-s15+s23+4*s34+s45)+p4*(p5+s15+s23-2*(s12+s34)+s45))-(s15-
     -   s34)*s45s)-r4r3*(p3*p5*s12-p4*s12s-p3*s12*s15+s12s*s15-p3*p5
     -   *s23+2*p3*s12*s23-p4*s12*s23+p5*s12*s23-s12s*s23+p3*s15*s23+
     -   s12*s15*s23+p5*s23s-s12*s23s-s12*s23*s34-s23s*s34+(p4*s12+p3
     -   *(p5-2*s12-s15)-p5*s23+s12*s23-s15*s23+s12*s34-2*(s12*s15-s2
     -   3*s34))*s45-p22*(p4-p5+s45)+p1*(-2*p32+p2*(p3+p4-s34)+(p4-s3
     -   4)*(s12-s23-s45)+p3*(s12+s23+2*(p4-p5-s15+s34)+s45))+p2*(-(p
     -   5*s12)-s12*s15-2*p5*s23+s12*s23+s23*s34+p3*(-p5+s15-2*(s23-s
     -   45))+p4*(2*s12+s23-s45)+(p5+s12+s15+s23-s34)*s45-s45s)+(s15-
     -   s34)*s45s)))
       d3=d*3.d0
       Id=1.d0/d
       I2=Id*0.5d0
       I3=1.d0/d3
       I4=Id*0.25d0
       x(1,1) = r4r3**2*(p22+(p3-s23)**2-2*p2*(p3+s23))+r3r2**2*(-4*p2
     -   *p4+(p3+s15-s23-s34)**2)+r2r1**2*(p32+(p4-s34)**2-2*p3*(p4+s
     -   34))-2*(r3r2*r4r3*(-((p3-s23)*(p3+s15-s23-s34))+p2*(p3+2*p4-
     -   s15+s23-s34))+r2r1*(r4r3*(-p32+p2*(p3+p4-s34)+s23*(-p4+s34)+
     -   p3*(p4-2*s15+s23+s34))-r3r2*(p32-2*p2*p4+p4*(s15+s23-s34)+s3
     -   4*(-s15+s23+s34)-p3*(p4-s15+s23+2*s34))))-4*m0sq*(p22*p4+s15
     -   *(p32+p4*s23-p3*(p4-s15+s23))-((p4+s15-s23)*s23+p3*(-p4+s15+
     -   s23))*s34-p2*(-p42+p3*(p4+s15-s23)+(-s15+s23)*s34+p4*(s15+s2
     -   3+s34))+s23*s34s)
       x(2,1) = r1r0*(r2r1*(-p32-(p4-s34)**2+2*p3*(p4+s34))+r4r3*(-p32
     -   +p2*(p3+p4-s34)+s23*(-p4+s34)+p3*(p4-2*s15+s23+s34))+r3r2*(-
     -   p32+2*p2*p4-p4*(s15+s23)+(p4+s15-s23)*s34+p3*(p4-s15+s23+2*s
     -   34)-s34s))+r4r3**2*(p22-2*p1*p3+s23*(s12+s23-s45)-p2*(p3+s12
     -   +2*s23-s45)+p3*(s12-s23+s45))+r3r2**2*(-2*p4*(p1+p2-s12)+(p3
     -   +s15-s23-s34)*(-p5+s15-s23+s45))+r3r2*r4r3*(-(p3*p5)+p3*s12+
     -   p3*s15-s12*s15+p5*s23+s12*s23-2*(-(p4*s12)+p3*s23+s15*s23-s2
     -   3s+p1*(p3+p4-s34))-s12*s34+s23*s34+(s15+2*(p3-s23)-s34)*s45+
     -   p2*(-p3-p5-2*(p4-s15+s23)+s34+s45))-2*m0sq*((p3+p4-s34)*(p3*
     -   p5-p3*s12-p4*s12-p3*s15+p3*s23-p5*s23+s15*s23-s23s+p1*(p3+p4
     -   -s34)+s12*s34+p2*(p3+p4+p5-s15+s23-s34-s45)-p3*s45+s23*s45)+
     -   2*p4*(p22-2*p1*p3+s23*(s12+s23-s45)-p2*(p3+s12+2*s23-s45)+p3
     -   *(s12-s23+s45))+(p3+s15-s23-s34)*(-(p2*(p3+p4-s34))+(p4-s34)
     -   *(s12+s23-s45)+p3*(s12-2*(p5-s15)-s23+s45)))+r2r1*(r4r3*(-(p
     -   2*(p3+p4-s34))+(p4-s34)*(s12+s23-s45)+p3*(s12-2*(p5-s15)-s23
     -   +s45))+r3r2*(-2*p2*p4+s34*(p5-s15+s23-s45)+p4*(-p5+2*s12+s15
     -   +s23-s45)+p3*(-p5+s15-s23+s45)))
       x(3,1) = r1r0*(r3r2*(4*p2*p4-(p3+s15-s23-s34)**2)+r4r3*(-((p3-s
     -   23)*(p3+s15-s23-s34))+p2*(p3+2*p4-s15+s23-s34))+r2r1*(-p32+2
     -   *p2*p4-p4*(s15+s23)+(p4+s15-s23)*s34+p3*(p4-s15+s23+2*s34)-s
     -   34s))+r3r2*r4r3*(s12*(p3+s15-s23-s34)+p1*(-p3-s15+s23+s34)+p
     -   2*(-p3+s15-s23+s34-2*(p5-s45)))+r4r3**2*(p22+s12*(p3-s23)-p1
     -   *(p2+p3-s23)-p2*(p3+s12+s23-2*s45))+r2r1**2*(2*p2*p4+p3*(p5-
     -   s15+s23-s45)+p4*(p5-2*s12-s15-s23+s45)+s34*(-p5+s15-s23+s45)
     -   )+2*m0sq*(-((p3+p4-s34)*(p1*(p3+s15-s23-s34)+s12*(-p3-s15+s2
     -   3+s34)+p2*(p3-s15+s23-s34+2*(p5-s45))))+2*p4*(-p22+p1*(p2+p3
     -   -s23)+s12*(-p3+s23)+p2*(p3+s12+s23-2*s45))-(p3+s15-s23-s34)*
     -   (s12*s15+p3*(-p5+s12+s15)+p5*s23-s12*s23-s12*s34-s23*s34-s15
     -   *s45+s34*s45+p2*(-p3-p5+s34+s45)))+r2r1*(r3r2*(2*p4*(p1+p2-s
     -   12)+(p3+s15-s23-s34)*(p5-s15+s23-s45))+r4r3*(-(p3*p5)+p3*s12
     -   -p4*s12+p3*s15+p3*s23+p5*s23+s15*s23-s23s+p1*(p3+p4-s34)-s12
     -   *s34-p3*s45+s23*s45+p2*(-p3+p4-p5-s15+s23+s34+s45)+2*(s12*s1
     -   5-s12*s23-s23*s34-s15*s45+s34*s45)))
       x(4,1) = r1r0*(r4r3*(-p22-(p3-s23)**2+2*p2*(p3+s23))+r3r2*(-((p
     -   3-s23)*(p3+s15-s23-s34))+p2*(p3+2*p4-s15+s23-s34))+r2r1*(-p3
     -   2+p2*(p3+p4-s34)+s23*(-p4+s34)+p3*(p4-2*s15+s23+s34)))+r3r2*
     -   *2*(p1*(p3+s15-s23-s34)+s12*(-p3-s15+s23+s34)+p2*(p3-s15+s23
     -   -s34+2*(p5-s45)))+r3r2*r4r3*(-p22+p1*(p2+p3-s23)+s12*(-p3+s2
     -   3)+p2*(p3+s12+s23-2*s45))+r2r1**2*(p2*(p3+p4-s34)-(p4-s34)*(
     -   s12+s23-s45)+p3*(-s12+2*(p5-s15)+s23-s45))+r2r1*(r3r2*(-(p4*
     -   s12)-s12*s15+p3*s23+s12*s23+s15*s23-s23s+p1*(p3+p4-s34)+s23*
     -   s34+2*(p3*p5-p3*s12-p3*s15-p5*s23+s12*s34)+p2*(p4-s15+s23+2*
     -   (p3+p5-s34-s45))-(p3-s15-s23+s34)*s45)+r4r3*(-p22+2*p1*p3-s2
     -   3*(s12+s23-s45)+p2*(p3+s12+2*s23-s45)-p3*(s12-s23+s45)))+2*m
     -   0sq*(p32*p5-p3*p4*s12-p32*s15+p3*s12*s15+p3*s12*s23+p4*s12*s
     -   23+p3*s15*s23+s12*s15*s23+p5*s23s-s12*s23s+p3*s23*s34-s23s*s
     -   34-2*(p3*p5*s23+s12*s23*s34)+p1*(-p32+p2*(p3+p4-s34)+s23*(-p
     -   4+s34)+p3*(p4-2*s15+s23+s34))+(p3-s23)*(s15-s34)*s45-p22*(p4
     -   -p5+s45)+p2*(-(s12*s15)-2*p5*s23+s12*s23+s23*s34+p4*(s12+s23
     -   -2*s45)+(s15+s23+s34)*s45+p3*(p4+s15-2*(p5+s23)+s45)))
       x(2,2) = r1r0**2*(p32+(p4-s34)**2-2*p3*(p4+s34))+r3r2**2*(-4*p1
     -   *p4+(p5-s15+s23-s45)**2)+r4r3**2*(-4*p1*p3+(p2-s12-s23+s45)*
     -   *2)-2*(r3r2*r4r3*(2*p1*(p3+p4-s34)+(p5-s15+s23-s45)*(p2-s12-
     -   s23+s45))-r1r0*(r4r3*(p2*(p3+p4-s34)-(p4-s34)*(s12+s23-s45)+
     -   p3*(-s12+2*(p5-s15)+s23-s45))+r3r2*(2*p2*p4+p3*(p5-s15+s23-s
     -   45)+p4*(p5-2*s12-s15-s23+s45)+s34*(-p5+s15-s23+s45))))-4*m0s
     -   q*(p22*p4+p3*p52-p3*p5*s12-p4*p5*s12+p4*s12s-2*p3*p5*s15+p3*
     -   s12*s15+p4*s12*s15+p3*s15s+p3*p5*s23-p4*p5*s23-p3*s12*s23+p4
     -   *s12*s23-p3*s15*s23+p4*s15*s23+p5*s12*s34-s12*s15*s34+p5*s23
     -   *s34+s12*s23*s34-s15*s23*s34+s23s*s34+p1*(p32+(p4-s34)**2-2*
     -   p3*(p4+s34))-((p3-p4)*(p5-s12-s15)+(p5+s12-s15+2*s23)*s34)*s
     -   45+p2*(p3*(p5-s15+s23-s45)+p4*(p5-2*s12-s15-s23+s45)+s34*(-p
     -   5+s15-s23+s45))+s34*s45s)
       x(3,2) = r1r0**2*(p32-2*p2*p4+p4*(s15+s23-s34)+s34*(-s15+s23+s3
     -   4)-p3*(p4-s15+s23+2*s34))+r4r3**2*((p2-s12)*(p2-s12-s23+s45)
     -   +p1*(-p2-2*p3-s12+s23+s45))+r3r2*r4r3*(-((p2-s12)*(p5-s15+s2
     -   3-s45))+p1*(-p5-s15+s23-2*(p3-s34)+s45))+r2r1*(r3r2*(4*p1*p4
     -   -(p5-s15+s23-s45)**2)+r4r3*(2*p1*(p3+p4-s34)+(p5-s15+s23-s45
     -   )*(p2-s12-s23+s45)))+r1r0*(r3r2*(2*p4*(p1+p2-s12)+(p3+s15-s2
     -   3-s34)*(p5-s15+s23-s45))+r4r3*(-(p4*s12)-s12*s15+p3*s23+s12*
     -   s23+s15*s23-s23s+p1*(p3+p4-s34)+s23*s34+2*(p3*p5-p3*s12-p3*s
     -   15-p5*s23+s12*s34)+p2*(p4-s15+s23+2*(p3+p5-s34-s45))-(p3-s15
     -   -s23+s34)*s45)+r2r1*(-2*p2*p4+s34*(p5-s15+s23-s45)+p4*(-p5+2
     -   *s12+s15+s23-s45)+p3*(-p5+s15-s23+s45)))-2*m0sq*((p3+p4-s34)
     -   *((p2-s12)*(p5-s15+s23-s45)+p1*(p5+s15-s23+2*(p3-s34)-s45))-
     -   2*p4*(p1*(p2+2*p3+s12-s23-s45)-(p2-s12)*(p2-s12-s23+s45))-(p
     -   5-s15+s23-s45)*(s12*s15+p3*(-p5+s12+s15)+p5*s23-s12*s23-s12*
     -   s34-s23*s34-s15*s45+s34*s45+p2*(-p3-p5+s34+s45)))
       x(4,2) = r1r0**2*(p32+s23*(p4-s34)-p2*(p3+p4-s34)-p3*(p4-2*s15+
     -   s23+s34))+r3r2**2*((p2-s12)*(p5-s15+s23-s45)+p1*(p5+s15-s23+
     -   2*(p3-s34)-s45))+r3r2*r4r3*(p1*(p2+2*p3+s12-s23-s45)-(p2-s12
     -   )*(p2-s12-s23+s45))+r2r1*(r3r2*(2*p1*(p3+p4-s34)+(p5-s15+s23
     -   -s45)*(p2-s12-s23+s45))+r4r3*(4*p1*p3-(p2-s12-s23+s45)**2))+
     -   r1r0*(r4r3*(-p22+2*p1*p3-s23*(s12+s23-s45)+p2*(p3+s12+2*s23-
     -   s45)-p3*(s12-s23+s45))+r2r1*(-(p2*(p3+p4-s34))+(p4-s34)*(s12
     -   +s23-s45)+p3*(s12-2*(p5-s15)-s23+s45))+r3r2*(-(p3*p5)+p3*s12
     -   -p4*s12+p3*s15+p3*s23+p5*s23+s15*s23-s23s+p1*(p3+p4-s34)-s12
     -   *s34-p3*s45+s23*s45+p2*(-p3+p4-p5-s15+s23+s34+s45)+2*(s12*s1
     -   5-s12*s23-s23*s34-s15*s45+s34*s45)))+2*m0sq*(p3*p5*s12-p4*s1
     -   2s-p3*s12*s15+s12s*s15-p3*p5*s23+2*p3*s12*s23-p4*s12*s23+p5*
     -   s12*s23-s12s*s23+p3*s15*s23+s12*s15*s23+p5*s23s-s12*s23s-s12
     -   *s23*s34-s23s*s34+(p4*s12+p3*(p5-2*s12-s15)-p5*s23+s12*s23-s
     -   15*s23+s12*s34-2*(s12*s15-s23*s34))*s45-p22*(p4-p5+s45)+p1*(
     -   -2*p32+p2*(p3+p4-s34)+(p4-s34)*(s12-s23-s45)+p3*(s12+s23+2*(
     -   p4-p5-s15+s34)+s45))+p2*(-(p5*s12)-s12*s15-2*p5*s23+s12*s23+
     -   s23*s34+p3*(-p5+s15-2*(s23-s45))+p4*(2*s12+s23-s45)+(p5+s12+
     -   s15+s23-s34)*s45-s45s)+(s15-s34)*s45s)
       x(3,3) = r4r3**2*(p12+(p2-s12)**2-2*p1*(p2+s12))+r1r0**2*(-4*p2
     -   *p4+(p3+s15-s23-s34)**2)+r2r1**2*(-4*p1*p4+(p5-s15+s23-s45)*
     -   *2)-4*m0sq*(p12*p4+p22*p4+p1*(-2*p4*(p2+s12)+(p3+s15-s23-s34
     -   )*(p3+p5-s34-s45))+p2*(-2*p4*s12+(p5-s15+s23-s45)*(p3+p5-s34
     -   -s45))+s12*(p4*s12+(p3+s15-s23-s34)*(-p5+s15-s23+s45)))+2*(r
     -   2r1*r4r3*((p2-s12)*(p5-s15+s23-s45)+p1*(p5+s15-s23+2*(p3-s34
     -   )-s45))+r1r0*(r4r3*(p1*(p3+s15-s23-s34)+s12*(-p3-s15+s23+s34
     -   )+p2*(p3-s15+s23-s34+2*(p5-s45)))+r2r1*(-2*p4*(p1+p2-s12)+(p
     -   3+s15-s23-s34)*(-p5+s15-s23+s45))))
       x(4,3) = r3r2*r4r3*(-p12-(p2-s12)**2+2*p1*(p2+s12))+r1r0**2*((p
     -   3-s23)*(p3+s15-s23-s34)+p2*(-p3-2*p4+s15-s23+s34))+r2r1**2*(
     -   -2*p1*(p3+p4-s34)+(-p2+s12+s23-s45)*(p5-s15+s23-s45))-2*m0sq
     -   *((4*p1*p2-(p1+p2-s12)**2)*(-p3-p4+s34)+(p2+p3-s23)*((p2-s12
     -   )*(p5-s15+s23-s45)+p1*(p5+s15-s23+2*(p3-s34)-s45))-(p1*(p3+s
     -   15-s23-s34)+s12*(-p3-s15+s23+s34)+p2*(p3-s15+s23-s34+2*(p5-s
     -   45)))*(p2-s12-s23+s45))+r2r1*(r4r3*(p1*(p2+2*p3+s12-s23-s45)
     -   -(p2-s12)*(p2-s12-s23+s45))+r3r2*(-((p2-s12)*(p5-s15+s23-s45
     -   ))+p1*(-p5-s15+s23-2*(p3-s34)+s45)))+r1r0*(r3r2*(s12*(p3+s15
     -   -s23-s34)+p1*(-p3-s15+s23+s34)+p2*(-p3+s15-s23+s34-2*(p5-s45
     -   )))+r4r3*(-p22+p1*(p2+p3-s23)+s12*(-p3+s23)+p2*(p3+s12+s23-2
     -   *s45))+r2r1*(-(p3*p5)+p3*s12+p3*s15-s12*s15+p5*s23+s12*s23-2
     -   *(-(p4*s12)+p3*s23+s15*s23-s23s+p1*(p3+p4-s34))-s12*s34+s23*
     -   s34+(s15+2*(p3-s23)-s34)*s45+p2*(-p3-p5-2*(p4-s15+s23)+s34+s
     -   45)))
       x(4,4) = r3r2**2*(p12+(p2-s12)**2-2*p1*(p2+s12))+r1r0**2*(p22+(
     -   p3-s23)**2-2*p2*(p3+s23))+r2r1**2*(-4*p1*p3+(p2-s12-s23+s45)
     -   **2)-2*(r2r1*r3r2*(p1*(p2+2*p3+s12-s23-s45)-(p2-s12)*(p2-s12
     -   -s23+s45))+r1r0*(r3r2*(-p22+p1*(p2+p3-s23)+s12*(-p3+s23)+p2*
     -   (p3+s12+s23-2*s45))-r2r1*(p22-2*p1*p3+s23*(s12+s23-s45)-p2*(
     -   p3+s12+2*s23-s45)+p3*(s12-s23+s45))))-4*m0sq*(p12*p3+s12*s23
     -   *(-p3+s12+s23)+p22*s45+s12*(p3-s23)*s45-p1*(-p32+s23*(s12-s4
     -   5)+p2*(p3-s12+s45)+p3*(s12+s23+s45))+p2*((p3-s12)*s23-(p3+s1
     -   2+s23)*s45+s45s))
c          
       x(1,0)= 2*r1r0*(p22*p4+s15*(p32+p4*s23-p3*(p4-s15+s23))-((p4+s1
     -   5-s23)*s23+p3*(-p4+s15+s23))*s34-p2*(-p42+p3*(p4+s15-s23)+(-
     -   s15+s23)*s34+p4*(s15+s23+s34))+s23*s34s)+r3r2*(-2*p4*(-p22+p
     -   1*(p2+p3-s23)+s12*(-p3+s23)+p2*(p3+s12+s23-2*s45))+(-((p3-s2
     -   3)*(p3+s15-s23-s34))+p2*(p3+2*p4-s15+s23-s34))*(p5-s15+s23-s
     -   45)+(p3+s15-s23-s34)*(-(p4*s12)+s12*s15+p3*s23-s12*s23+s15*s
     -   23+p2*(p4-s15+s23)-s23s+p1*(p3+p4-s34)-s23*s34-(p3+s15-s23-s
     -   34)*s45))+r4r3*(-((p3+p4-s34)*(-p22+p1*(p2+p3-s23)+s12*(-p3+
     -   s23)+p2*(p3+s12+s23-2*s45)))+(4*p2*p3-(p2+p3-s23)**2)*(p5-s1
     -   5+s23-s45)+(p3+s15-s23-s34)*(-p22+2*p1*p3-s23*(s12+s23-s45)+
     -   p2*(p3+s12+2*s23-s45)-p3*(s12-s23+s45)))+r2r1*((-p32+p2*(p3+
     -   p4-s34)+s23*(-p4+s34)+p3*(p4-2*s15+s23+s34))*(p5-s15+s23-s45
     -   )+(p3+p4-s34)*(-(p4*s12)+s12*s15+p3*s23-s12*s23+s15*s23+p2*(
     -   p4-s15+s23)-s23s+p1*(p3+p4-s34)-s23*s34-(p3+s15-s23-s34)*s45
     -   )+2*p4*(p22-2*p1*p3+s23*(s12+s23-s45)-p2*(p3+s12+2*s23-s45)+
     -   p3*(s12-s23+s45)))
       x(2,0)= r3r2*((p5-s15+s23-s45)*(p3*p5-p3*s12-p4*s12-p3*s15+p3*s
     -   23-p5*s23+s15*s23-s23s+p1*(p3+p4-s34)+s12*s34+p2*(p3+p4+p5-s
     -   15+s23-s34-s45)-p3*s45+s23*s45)-2*p4*(p1*(p2+2*p3+s12-s23-s4
     -   5)-(p2-s12)*(p2-s12-s23+s45))+(p3+s15-s23-s34)*(2*p1*(p3+p4-
     -   s34)+(p5-s15+s23-s45)*(p2-s12-s23+s45)))+r4r3*(-((p3+p4-s34)
     -   *(p1*(p2+2*p3+s12-s23-s45)-(p2-s12)*(p2-s12-s23+s45)))+(p3+s
     -   15-s23-s34)*(4*p1*p3-(p2-s12-s23+s45)**2)-(p5-s15+s23-s45)*(
     -   p22-2*p1*p3+s23*(s12+s23-s45)-p2*(p3+s12+2*s23-s45)+p3*(s12-
     -   s23+s45)))+r1r0*((p3+p4-s34)*(p3*p5-p3*s12-p4*s12-p3*s15+p3*
     -   s23-p5*s23+s15*s23-s23s+p1*(p3+p4-s34)+s12*s34+p2*(p3+p4+p5-
     -   s15+s23-s34-s45)-p3*s45+s23*s45)+2*p4*(p22-2*p1*p3+s23*(s12+
     -   s23-s45)-p2*(p3+s12+2*s23-s45)+p3*(s12-s23+s45))+(p3+s15-s23
     -   -s34)*(-(p2*(p3+p4-s34))+(p4-s34)*(s12+s23-s45)+p3*(s12-2*(p
     -   5-s15)-s23+s45)))+2*r2r1*(p22*p4+p3*p52-p3*p5*s12-p4*p5*s12+
     -   p4*s12s-2*p3*p5*s15+p3*s12*s15+p4*s12*s15+p3*s15s+p3*p5*s23-
     -   p4*p5*s23-p3*s12*s23+p4*s12*s23-p3*s15*s23+p4*s15*s23+p5*s12
     -   *s34-s12*s15*s34+p5*s23*s34+s12*s23*s34-s15*s23*s34+s23s*s34
     -   +p1*(p32+(p4-s34)**2-2*p3*(p4+s34))-((p3-p4)*(p5-s12-s15)+(p
     -   5+s12-s15+2*s23)*s34)*s45+p2*(p3*(p5-s15+s23-s45)+p4*(p5-2*s
     -   12-s15-s23+s45)+s34*(-p5+s15-s23+s45))+s34*s45s)
       x(3,0)= r4r3*((4*p1*p2-(p1+p2-s12)**2)*(-p3-p4+s34)-(p22+s12*(p
     -   3-s23)-p1*(p2+p3-s23)-p2*(p3+s12+s23-2*s45))*(p5-s15+s23-s45
     -   )+(p3+s15-s23-s34)*(p1*(p2+2*p3+s12-s23-s45)-(p2-s12)*(p2-s1
     -   2-s23+s45)))+2*r3r2*(p12*p4+p22*p4+p1*(-2*p4*(p2+s12)+(p3+s1
     -   5-s23-s34)*(p3+p5-s34-s45))+p2*(-2*p4*s12+(p5-s15+s23-s45)*(
     -   p3+p5-s34-s45))+s12*(p4*s12+(p3+s15-s23-s34)*(-p5+s15-s23+s4
     -   5)))+r1r0*((p3+p4-s34)*(p1*(p3+s15-s23-s34)+s12*(-p3-s15+s23
     -   +s34)+p2*(p3-s15+s23-s34+2*(p5-s45)))-2*p4*(-p22+p1*(p2+p3-s
     -   23)+s12*(-p3+s23)+p2*(p3+s12+s23-2*s45))+(p3+s15-s23-s34)*(s
     -   12*s15+p3*(-p5+s12+s15)+p5*s23-s12*s23-s12*s34-s23*s34-s15*s
     -   45+s34*s45+p2*(-p3-p5+s34+s45)))+r2r1*((p3+p4-s34)*((p2-s12)
     -   *(p5-s15+s23-s45)+p1*(p5+s15-s23+2*(p3-s34)-s45))-2*p4*(p1*(
     -   p2+2*p3+s12-s23-s45)-(p2-s12)*(p2-s12-s23+s45))-(p5-s15+s23-
     -   s45)*(s12*s15+p3*(-p5+s12+s15)+p5*s23-s12*s23-s12*s34-s23*s3
     -   4-s15*s45+s34*s45+p2*(-p3-p5+s34+s45)))
       x(4,0)= r3r2*((4*p1*p2-(p1+p2-s12)**2)*(-p3-p4+s34)+(p2+p3-s23)
     -   *((p2-s12)*(p5-s15+s23-s45)+p1*(p5+s15-s23+2*(p3-s34)-s45))-
     -   (p1*(p3+s15-s23-s34)+s12*(-p3-s15+s23+s34)+p2*(p3-s15+s23-s3
     -   4+2*(p5-s45)))*(p2-s12-s23+s45))+r1r0*(-(p32*p5)+p3*p4*s12+p
     -   32*s15-p3*s12*s15-p3*s12*s23-p4*s12*s23-p3*s15*s23-s12*s15*s
     -   23-p5*s23s+s12*s23s-p3*s23*s34+s23s*s34+2*(p3*p5*s23+s12*s23
     -   *s34)-p1*(-p32+p2*(p3+p4-s34)+s23*(-p4+s34)+p3*(p4-2*s15+s23
     -   +s34))-(p3-s23)*(s15-s34)*s45+p22*(p4-p5+s45)-p2*(-(s12*s15)
     -   -2*p5*s23+s12*s23+s23*s34+p4*(s12+s23-2*s45)+(s15+s23+s34)*s
     -   45+p3*(p4+s15-2*(p5+s23)+s45)))+2*r4r3*(p12*p3+s12*s23*(-p3+
     -   s12+s23)+p22*s45+s12*(p3-s23)*s45-p1*(-p32+s23*(s12-s45)+p2*
     -   (p3-s12+s45)+p3*(s12+s23+s45))+p2*((p3-s12)*s23-(p3+s12+s23)
     -   *s45+s45s))+r2r1*(-(p3*p5*s12)+p4*s12s+p3*s12*s15-s12s*s15+p
     -   3*p5*s23-2*p3*s12*s23+p4*s12*s23-p5*s12*s23+s12s*s23-p3*s15*
     -   s23-s12*s15*s23-p5*s23s+s12*s23s+s12*s23*s34+s23s*s34-(p4*s1
     -   2+p3*(p5-2*s12-s15)-p5*s23+s12*s23-s15*s23+s12*s34-2*(s12*s1
     -   5-s23*s34))*s45+p22*(p4-p5+s45)-p1*(-2*p32+p2*(p3+p4-s34)+(p
     -   4-s34)*(s12-s23-s45)+p3*(s12+s23+2*(p4-p5-s15+s34)+s45))-(s1
     -   5-s34)*s45s+p2*(p5*s12+s12*s15+2*p5*s23-s12*s23-s23*s34+p3*(
     -   p5-s15+2*(s23-s45))-(p5+s12+s15+s23-s34)*s45+p4*(-2*s12-s23+
     -   s45)+s45s))

 

       x(1,2) = x(2,1)
       x(1,3) = x(3,1)
       x(2,3) = x(3,2)
       x(1,4) = x(4,1)
       x(2,4) = x(4,2)
       x(3,4) = x(4,3)
      


C
      Y(1,1,1)=0
      Y(2,1,1)=(x(1,2)*x(1,0)-x(2,0)*x(1,1))*Id
      Y(3,1,1)=(x(1,3)*x(1,0)-x(3,0)*x(1,1))*Id
      Y(4,1,1)=(x(1,4)*x(1,0)-x(4,0)*x(1,1))*Id
      Y(1,2,1)=-Y(2,1,1)
      Y(2,2,1)=0
      Y(3,2,1)=(x(1,3)*x(2,0)-x(3,0)*x(1,2))*Id
      Y(4,2,1)=(x(1,4)*x(2,0)-x(4,0)*x(1,2))*Id
      Y(1,3,1)=-Y(3,1,1)
      Y(2,3,1)=-Y(3,2,1)
      Y(3,3,1)=0
      Y(4,3,1)=(x(1,4)*x(3,0)-x(4,0)*x(1,3))*Id
      Y(1,4,1)=-Y(4,1,1)
      Y(2,4,1)=-Y(4,2,1)
      Y(3,4,1)=-Y(4,3,1)
      Y(4,4,1)=0
      Y(1,1,2)=0
      Y(2,1,2)=(x(2,2)*x(1,0)-x(2,0)*x(2,1))*Id
      Y(3,1,2)=(x(2,3)*x(1,0)-x(3,0)*x(2,1))*Id
      Y(4,1,2)=(x(2,4)*x(1,0)-x(4,0)*x(2,1))*Id
      Y(1,2,2)=-Y(2,1,2)
      Y(2,2,2)=0
      Y(3,2,2)=(x(2,3)*x(2,0)-x(3,0)*x(2,2))*Id
      Y(4,2,2)=(x(2,4)*x(2,0)-x(4,0)*x(2,2))*Id
      Y(1,3,2)=-Y(3,1,2)
      Y(2,3,2)=-Y(3,2,2)
      Y(3,3,2)=0
      Y(4,3,2)=(x(2,4)*x(3,0)-x(4,0)*x(2,3))*Id
      Y(1,4,2)=-Y(4,1,2)
      Y(2,4,2)=-Y(4,2,2)
      Y(3,4,2)=-Y(4,3,2)
      Y(4,4,2)=0
      Y(1,1,3)=0
      Y(2,1,3)=(x(3,2)*x(1,0)-x(2,0)*x(3,1))*Id
      Y(3,1,3)=(x(3,3)*x(1,0)-x(3,0)*x(3,1))*Id
      Y(4,1,3)=(x(3,4)*x(1,0)-x(4,0)*x(3,1))*Id
      Y(1,2,3)=-Y(2,1,3)
      Y(2,2,3)=0
      Y(3,2,3)=(x(3,3)*x(2,0)-x(3,0)*x(3,2))*Id
      Y(4,2,3)=(x(3,4)*x(2,0)-x(4,0)*x(3,2))*Id
      Y(1,3,3)=-Y(3,1,3)
      Y(2,3,3)=-Y(3,2,3)
      Y(3,3,3)=0
      Y(4,3,3)=(x(3,4)*x(3,0)-x(4,0)*x(3,3))*Id
      Y(1,4,3)=-Y(4,1,3)
      Y(2,4,3)=-Y(4,2,3)
      Y(3,4,3)=-Y(4,3,3)
      Y(4,4,3)=0
      Y(1,1,4)=0
      Y(2,1,4)=(x(4,2)*x(1,0)-x(2,0)*x(4,1))*Id
      Y(3,1,4)=(x(4,3)*x(1,0)-x(3,0)*x(4,1))*Id
      Y(4,1,4)=(x(4,4)*x(1,0)-x(4,0)*x(4,1))*Id
      Y(1,2,4)=-Y(2,1,4)
      Y(2,2,4)=0
      Y(3,2,4)=(x(4,3)*x(2,0)-x(3,0)*x(4,2))*Id
      Y(4,2,4)=(x(4,4)*x(2,0)-x(4,0)*x(4,2))*Id
      Y(1,3,4)=-Y(3,1,4)
      Y(2,3,4)=-Y(3,2,4)
      Y(3,3,4)=0
      Y(4,3,4)=(x(4,4)*x(3,0)-x(4,0)*x(4,3))*Id
      Y(1,4,4)=-Y(4,1,4)     
      Y(2,4,4)=-Y(4,2,4)    
      Y(3,4,4)=-Y(4,3,4)
      Y(4,4,4)=0
c
      Y123=Y(1,3,2)+Y(1,2,3)
      Y423=Y(4,2,3)+Y(4,3,2)
      Y124=Y(1,4,2)+Y(1,2,4)
      Y324=Y(3,2,4)+Y(3,4,2)
      Y412=Y(4,1,2)+Y(4,2,1)
      Y312=Y(3,2,1)+Y(3,1,2)
      Y213=Y(2,3,1)+Y(2,1,3)
      Y413=Y(4,1,3)+Y(4,3,1)
      Y214=Y(2,4,1)+Y(2,1,4)
      Y314=Y(3,1,4)+Y(3,4,1)
      Y134=Y(1,4,3)+Y(1,3,4)
      Y234=Y(2,3,4)+Y(2,4,3)
c  Rank-1
      R(1)=DR1345-DR2345
      R(2)=DR1245-DR1345
      R(3)=DR1235-DR1245
      R(4)=DR1234-DR1235
c 1
      E(1,1)=(R(1)*x(1,1)+R(2)*x(2,1)+R(3)*x(3,1)+R(4)*x(4,1)
     /         -DR2345*x(1,0))*Id
c 2
      E(2,1)=(R(1)*x(1,2)+R(2)*x(2,2)+R(3)*x(3,2)+R(4)*x(4,2)   
     /           -DR2345*x(2,0))*Id
c 3
      E(3,1)=(R(1)*x(1,3)+R(2)*x(2,3)+R(3)*x(3,3)+R(4)*x(4,3)   
     /           -DR2345*x(3,0))*Id
c 4
      E(4,1)=(R(1)*x(1,4)+R(2)*x(2,4)+R(3)*x(3,4)+R(4)*x(4,4)   
     /          -DR2345*x(4,0))*Id
c  Rank-2
      R(1)=DRR1345(7,2)-DRR2345(7,2)
      R(2)=DRR1245(7,2)-DRR1345(7,2)
      R(3)=DRR1235(7,2)-DRR1245(7,2)
      R(4)=DRR1234(7,2)-DRR1235(7,2)

      R1(1)= DRR1345(1,1) + DR2345
      R1(2)= DRR1245(1,1) - DRR1345(1,1)
      R1(3)= DRR1235(1,1) - DRR1245(1,1)
      R1(4)= DRR1234(1,1) - DRR1235(1,1)

      R2(1)= DRR1345(1,1) - DRR2345(1,1)
      R2(2)= DRR1245(2,1) - DRR1345(1,1)
      R2(3)= DRR1235(2,1) - DRR1245(2,1)
      R2(4)= DRR1234(2,1) - DRR1235(2,1) 

      R3(1)= DRR1345(2,1) - DRR2345(2,1)
      R3(2)= DRR1245(2,1) - DRR1345(2,1)
      R3(3)= DRR1235(3,1) - DRR1245(2,1)
      R3(4)= DRR1234(3,1) - DRR1235(3,1) 
     
      R4(1)= DRR1345(3,1) - DRR2345(3,1)
      R4(2)= DRR1245(3,1) - DRR1345(3,1)
      R4(3)= DRR1235(3,1) - DRR1245(3,1)
      R4(4)=               - DRR1235(3,1) 

c 1 1
      E(1,2)=((R(2)*Y(2,1,1)+R(3)*Y(3,1,1)+R(4)*Y(4,1,1))*2.d0+
     \ R1(1)*x(1,1)+R1(2)*x(2,1)+R1(3)*x(3,1)+R1(4)*x(4,1)+DR2345*x(1,0))*Id
c 2 2 
      E(2,2)=((R(1)*Y(1,2,2)+R(3)*Y(3,2,2)+R(4)*Y(4,2,2))*2.d0+
     \R2(1)*x(1,2)+R2(2)*x(2,2)+R2(3)*x(3,2)+R2(4)*x(4,2)-DRR2345(1,1)*x(2,0))*Id
c 3 3
      E(3,2)=((R(1)*Y(1,3,3)+R(2)*Y(2,3,3)+R(4)*Y(4,3,3))*2.d0+
     \R3(1)*x(1,3)+R3(2)*x(2,3)+R3(3)*x(3,3)+R3(4)*x(4,3)-DRR2345(2,1)*x(3,0))*Id
c 4 4
      E(4,2)=((R(1)*Y(1,4,4)+R(2)*Y(2,4,4)+R(3)*Y(3,4,4))*2.d0+
     \R4(1)*x(1,4)+R4(2)*x(2,4)+R4(3)*x(3,4)+R4(4)*x(4,4)-DRR2345(3,1)*x(4,0))*Id
c 1 2
      E(5,2)=((R(1)*Y(1,2,1)+R(2)*Y(2,1,2)+R(3)*Y312+R(4)*Y412)*2.d0+
     \R1(1)*x(1,2)+R1(2)*x(2,2)+R1(3)*x(3,2)+R1(4)*x(4,2)+R2(1)*x(1,1)+
     \R2(2)*x(2,1)+R2(3)*x(3,1)+R2(4)*x(4,1)+DR2345*x(2,0)-DRR2345(1,1)*x(1,0))*I2
c 1 3
      E(6,2)=((R(1)*Y(1,3,1)+R(2)*Y213+R(3)*Y(3,1,3)+R(4)*Y413)*2.d0+
     \R1(1)*x(1,3)+R1(2)*x(2,3)+R1(3)*x(3,3)+R1(4)*x(4,3)+R3(1)*x(1,1)+
     \R3(2)*x(2,1)+R3(3)*x(3,1)+R3(4)*x(4,1)+DR2345*x(3,0)-DRR2345(2,1)*x(1,0))*I2
c 1 4
      E(7,2)=((R(1)*Y(1,4,1)+R(2)*Y214+R(3)*Y314+R(4)*Y(4,1,4))*2.d0+
     \R1(1)*x(1,4)+R1(2)*x(2,4)+R1(3)*x(3,4)+R1(4)*x(4,4)+R4(1)*x(1,1)+
     \R4(2)*x(2,1)+R4(3)*x(3,1)+R4(4)*x(4,1)+DR2345*x(4,0)-DRR2345(3,1)*x(1,0))*I2
c 2 3
      E(8,2)=((R(1)*Y123+R(2)*Y(2,3,2)+R(3)*Y(3,2,3)+R(4)*Y423)*2.d0+
     \R3(1)*x(1,2)+R3(2)*x(2,2)+R3(3)*x(3,2)+R3(4)*x(4,2)+R2(1)*x(1,3)+
     \R2(2)*x(2,3)+R2(3)*x(3,3)+R2(4)*x(4,3)-DRR2345(1,1)*x(3,0)-DRR2345(2,1)*x(2,0))*I2
c 2 4
      E(9,2)=((R(1)*Y124+R(2)*Y(2,4,2)+R(3)*Y324+R(4)*Y(4,2,4))*2.d0+
     \R4(1)*x(1,2)+R4(2)*x(2,2)+R4(3)*x(3,2)+R4(4)*x(4,2)+R2(1)*x(1,4)+
     \R2(2)*x(2,4)+R2(3)*x(3,4)+R2(4)*x(4,4)-DRR2345(1,1)*x(4,0)-DRR2345(3,1)*x(2,0))*I2
c 3 4
      E(10,2)=((R(1)*Y134+R(2)*Y234+R(3)*Y(3,4,3)+R(4)*Y(4,3,4))*2.d0+
     \R4(1)*x(1,3)+R4(2)*x(2,3)+R4(3)*x(3,3)+R4(4)*x(4,3)+R3(1)*x(1,4)+
     \R3(2)*x(2,4)+R3(3)*x(3,4)+R3(4)*x(4,4)-DRR2345(2,1)*x(4,0)-DRR2345(3,1)*x(3,0))*I2
C 00
      E(11,2)=(R(1)*x(1,0)+R(2)*x(2,0)+R(3)*x(3,0)+R(4)*x(4,0))*Id

cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
cccccccccccccccccccccccccccccccccccccccccccccccccc

c  Rank-1
      R(1)=DI1345-DI2345
      R(2)=DI1245-DI1345
      R(3)=DI1235-DI1245
      R(4)=DI1234-DI1235
c 1
      C(1,1)=(R(1)*x(1,1)+R(2)*x(2,1)+R(3)*x(3,1)+R(4)*x(4,1)
     /         -DI2345*x(1,0))*Id
c 2
      C(2,1)=(R(1)*x(1,2)+R(2)*x(2,2)+R(3)*x(3,2)+R(4)*x(4,2)   
     /           -DI2345*x(2,0))*Id
c 3
      C(3,1)=(R(1)*x(1,3)+R(2)*x(2,3)+R(3)*x(3,3)+R(4)*x(4,3)   
     /           -DI2345*x(3,0))*Id
c 4
      C(4,1)=(R(1)*x(1,4)+R(2)*x(2,4)+R(3)*x(3,4)+R(4)*x(4,4)   
     /          -DI2345*x(4,0))*Id
c  Rank-2
      R(1)=DII1345(7,2)-DII2345(7,2)
      R(2)=DII1245(7,2)-DII1345(7,2)
      R(3)=DII1235(7,2)-DII1245(7,2)
      R(4)=DII1234(7,2)-DII1235(7,2)

      R1(1)= DII1345(1,1) + DI2345
      R1(2)= DII1245(1,1) - DII1345(1,1)
      R1(3)= DII1235(1,1) - DII1245(1,1)
      R1(4)= DII1234(1,1) - DII1235(1,1)

      R2(1)= DII1345(1,1) - DII2345(1,1)
      R2(2)= DII1245(2,1) - DII1345(1,1)
      R2(3)= DII1235(2,1) - DII1245(2,1)
      R2(4)= DII1234(2,1) - DII1235(2,1) 

      R3(1)= DII1345(2,1) - DII2345(2,1)
      R3(2)= DII1245(2,1) - DII1345(2,1)
      R3(3)= DII1235(3,1) - DII1245(2,1)
      R3(4)= DII1234(3,1) - DII1235(3,1) 
     
      R4(1)= DII1345(3,1) - DII2345(3,1)
      R4(2)= DII1245(3,1) - DII1345(3,1)
      R4(3)= DII1235(3,1) - DII1245(3,1)
      R4(4)=               - DII1235(3,1) 

c 1 1
      C(1,2)=((R(2)*Y(2,1,1)+R(3)*Y(3,1,1)+R(4)*Y(4,1,1))*2.d0+
     \ R1(1)*x(1,1)+R1(2)*x(2,1)+R1(3)*x(3,1)+R1(4)*x(4,1)+DI2345*x(1,0))*Id
c 2 2 
      C(2,2)=((R(1)*Y(1,2,2)+R(3)*Y(3,2,2)+R(4)*Y(4,2,2))*2.d0+
     \R2(1)*x(1,2)+R2(2)*x(2,2)+R2(3)*x(3,2)+R2(4)*x(4,2)-DII2345(1,1)*x(2,0))*Id
c 3 3
      C(3,2)=((R(1)*Y(1,3,3)+R(2)*Y(2,3,3)+R(4)*Y(4,3,3))*2.d0+
     \R3(1)*x(1,3)+R3(2)*x(2,3)+R3(3)*x(3,3)+R3(4)*x(4,3)-DII2345(2,1)*x(3,0))*Id
c 4 4
      C(4,2)=((R(1)*Y(1,4,4)+R(2)*Y(2,4,4)+R(3)*Y(3,4,4))*2.d0+
     \R4(1)*x(1,4)+R4(2)*x(2,4)+R4(3)*x(3,4)+R4(4)*x(4,4)-DII2345(3,1)*x(4,0))*Id
c 1 2
      C(5,2)=((R(1)*Y(1,2,1)+R(2)*Y(2,1,2)+R(3)*Y312+R(4)*Y412)*2.d0+
     \R1(1)*x(1,2)+R1(2)*x(2,2)+R1(3)*x(3,2)+R1(4)*x(4,2)+R2(1)*x(1,1)+
     \R2(2)*x(2,1)+R2(3)*x(3,1)+R2(4)*x(4,1)+DI2345*x(2,0)-DII2345(1,1)*x(1,0))*I2
c 1 3
      C(6,2)=((R(1)*Y(1,3,1)+R(2)*Y213+R(3)*Y(3,1,3)+R(4)*Y413)*2.d0+
     \R1(1)*x(1,3)+R1(2)*x(2,3)+R1(3)*x(3,3)+R1(4)*x(4,3)+R3(1)*x(1,1)+
     \R3(2)*x(2,1)+R3(3)*x(3,1)+R3(4)*x(4,1)+DI2345*x(3,0)-DII2345(2,1)*x(1,0))*I2
c 1 4
      C(7,2)=((R(1)*Y(1,4,1)+R(2)*Y214+R(3)*Y314+R(4)*Y(4,1,4))*2.d0+
     \R1(1)*x(1,4)+R1(2)*x(2,4)+R1(3)*x(3,4)+R1(4)*x(4,4)+R4(1)*x(1,1)+
     \R4(2)*x(2,1)+R4(3)*x(3,1)+R4(4)*x(4,1)+DI2345*x(4,0)-DII2345(3,1)*x(1,0))*I2
c 2 3
      C(8,2)=((R(1)*Y123+R(2)*Y(2,3,2)+R(3)*Y(3,2,3)+R(4)*Y423)*2.d0+
     \R3(1)*x(1,2)+R3(2)*x(2,2)+R3(3)*x(3,2)+R3(4)*x(4,2)+R2(1)*x(1,3)+
     \R2(2)*x(2,3)+R2(3)*x(3,3)+R2(4)*x(4,3)-DII2345(1,1)*x(3,0)-DII2345(2,1)*x(2,0))*I2
c 2 4
      C(9,2)=((R(1)*Y124+R(2)*Y(2,4,2)+R(3)*Y324+R(4)*Y(4,2,4))*2.d0+
     \R4(1)*x(1,2)+R4(2)*x(2,2)+R4(3)*x(3,2)+R4(4)*x(4,2)+R2(1)*x(1,4)+
     \R2(2)*x(2,4)+R2(3)*x(3,4)+R2(4)*x(4,4)-DII2345(1,1)*x(4,0)-DII2345(3,1)*x(2,0))*I2
c 3 4
      C(10,2)=((R(1)*Y134+R(2)*Y234+R(3)*Y(3,4,3)+R(4)*Y(4,3,4))*2.d0+
     \R4(1)*x(1,3)+R4(2)*x(2,3)+R4(3)*x(3,3)+R4(4)*x(4,3)+R3(1)*x(1,4)+
     \R3(2)*x(2,4)+R3(3)*x(3,4)+R3(4)*x(4,4)-DII2345(2,1)*x(4,0)-DII2345(3,1)*x(3,0))*I2
C 00
      C(11,2)=(R(1)*x(1,0)+R(2)*x(2,0)+R(3)*x(3,0)+R(4)*x(4,0))*Id
        end
